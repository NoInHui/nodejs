<div style="color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;"><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 와 await</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 와 await 라는 특별한 문법을 사용하면 프라미스를 좀 더 편하게 사용할 수 있습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async, await 는 놀라울 정도로 이해하기 쉽고 사용법도 어렵지 않습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 함수</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 키워드부터 알아봅시다. async 는 function 앞에 위치합니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">return</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(181, 206, 168); font-size: 10pt;">1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">;</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// function 앞에 async 를 붙이면 해당 함수는 항상 프라미스를 반환합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 프라미스가 아닌 값을 반환하더라도 이행 상태의 프라미스(resolved promise) 로 감싸 이행된 프라미스가 반환되도록 합니다.</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">().</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">then</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 명시적으로 프라미스를 반환하는 것도 가능한데 결과는 동일합니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func2</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">return</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">((</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(181, 206, 168); font-size: 10pt;">1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func2</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">().</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">then</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 가 붙은 함수는 반드시 프라미스를 반환하고, 프라미스가 아닌 것은 프라미스로 감싸 반환합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 그런데 async 가 제공하는 기능은 이뿐만이 아닙니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 또 다른 키워드 await 는 async 함수 안에서만 동작합니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 문법은 다음과 같습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// let value = await promise;</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 자바스크립트는 await 키워드를 만나면 프라미스가 처리될 때까지 기다립니다. 결과는 그 이후 반환됩니다.</span></div><br><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func3</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">((</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">setTimeout</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(() </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'func3'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">), </span><span style="color: rgb(181, 206, 168); font-size: 10pt;">2000</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; });</span></div><br><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">;</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func3</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">();</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 함수를 호출하고, 함수 본문이 실행되는 도중에 await 에서 실행이 잠시 중단되었다가 프라미스가 처리되면 실행이 재개됩니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 이때 프라미스 객체의 result 값이 변수 result 에 할당됩니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 는 말 그대로 프라미스가 처리될 때까지 함수 실행을 기다리게 만듭니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 프라미스가 처리되면 그 결과와 함께 실행이 재개되죠.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 프라미스가 처리되길 기다리는 동안엔 엔진이 다른 일을 할 수 있기 때문에, CPU 리소스가 낭비되지 않습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 는 promise.then 보다 좀 더 세련되게 프라미스의 result 값을 얻을 수 있도록 해주는 문법입니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// promise.then 보다 가독성 좋고 쓰기도 쉽습니다.</span></div><br><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func4</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(106, 153, 85); font-size: 10pt;">// JSON 읽기</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'/save/jsonData.json'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">data</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">json</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">();</span></div><br><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 3초 대기</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">((</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">setTimeout</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(181, 206, 168); font-size: 10pt;">3000</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">data</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func4</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">();</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 는 최상위 레벨 코드에서 작동하지 않습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 을 이제 막 시작하기 시작한 분들은 최상위 레벨 코드에 await 을 사용할 수 없다는 사실을 잊곤 합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 아래와 같은 코드는 동작하지 않습니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'/save/jsonData.json'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 하지만 익명 async 함수로 코드를 감싸면 최상위 레벨 코드에도 await 를 작성할 수 있습니다.</span></div><br><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> () </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'/save/jsonData.json'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">json</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">());</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">})();</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async 클래스 메서드</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 메서드 이름 앞에 async 를 추가하면 async 클래스 메서드를 선언할 수 있습니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">class</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Class1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">return</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'Class1'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">)</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; }</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Class1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">().</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">().</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">then</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">result</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><br><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 에러 핸들링</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 프라미스가 정상적으로 이행되면 await promise 는 프라미스 객체의 result 에 저장된 값을 반환합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 반면 프라미스가 거부되면 마치 throw 문을 작성한 것처럼 에러가 던져집니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func5</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Error</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'error'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 위 코드는 아래 코드와 동일합니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func6</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">throw</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Error</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'error'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 실제 상황에선 프라미스가 거부 되기 전에 약간의 시간이 지체되는 경우가 있습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 이런 경우엔 await 가 에러를 던지기 전에 지연이 발생합니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// await 가 던진 에러는 throw 가 던진 에러를 잡을 때처럼 try..catch 를 사용해 잡을 수 있습니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func7</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">try</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'http://blabla'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; } </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">catch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; }</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func7</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">();</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// try..catch 가 없으면 아래 예시의 async 함수를 호출해 만든 프라미스가 거부 상태가 됩니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// .catch 를 추가하면 거부된 프라미스를 처리할 수 있습니다.</span></div><br><div><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">function</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">func8</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">() {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">response</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'http://blabla'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">}</span></div><br><div><span style="color: rgb(220, 220, 170); font-size: 10pt;">func8</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">().</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">catch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">));</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// .catch 를 추가하는 걸 잊으면 처리되지 않은 프라미스 에러가 발생합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 이런 에러는 프라미스와 에러 핸들링 챕터에서 설명한 전역 이벤트 핸들러 unhandledrejection 을 사용해 잡을 수 있습니다.</span></div><br><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async / await 와 promise.then / catch</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async/await 을 사용하면 await 가 대기를 처리해주기 때문에 .then 이 거의 필요하지 않습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 여기에 더하여 .catch 대신 일반 try..catch 를 사용할 수 있다는 장점도 생깁니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 항상 그러한 것은 아니지만, promise.then 을 사용하는 것보다 async / await 를 사용하는 것이 대개는 더 편리합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 그런데 문법 제약 때문에 async 함수 바깥의 최상위 레벨 코드에선 await 를 사용할 수 없습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 그렇기 때문에 관행처럼 .then/catch 를 추가해 최종 결과나 처리되지 못한 에러를 다룹니다.</span></div><br><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async / await 는 Promise.all 과도 함께 쓸 수 있습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 여러 개의 프라미스가 모두 처리되길 기다려야 하는 상황이라면 이 프라미스들은 Promise.all 로 감싸고 여기에 await 를 붙여 사용할 수 있습니다.</span></div><br><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">async</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> () </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">try</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">let</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">results</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> = </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">await</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">all</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">([</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'/save/jsonData.json'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">)</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">fetch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'/save/jsonData.json'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">)</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">((</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">setTimeout</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(() </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(206, 145, 120); font-size: 10pt;">'test'</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">), </span><span style="color: rgb(181, 206, 168); font-size: 10pt;">2000</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">))</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; , </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">new</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(78, 201, 176); font-size: 10pt;">Promise</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">((</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">, </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">reject</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) </span><span style="color: rgb(86, 156, 214); font-size: 10pt;">=&gt;</span><span style="color: rgb(212, 212, 212); font-size: 10pt;"> </span><span style="color: rgb(220, 220, 170); font-size: 10pt;">resolve</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(181, 206, 168); font-size: 10pt;">1</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">)),</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]);</span></div><br><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">results</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; } </span><span style="color: rgb(197, 134, 192); font-size: 10pt;">catch</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">) {</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: rgb(156, 220, 254); font-size: 10pt;">console</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">.</span><span style="color: rgb(220, 220, 170); font-size: 10pt;">log</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">(</span><span style="color: rgb(156, 220, 254); font-size: 10pt;">e</span><span style="color: rgb(212, 212, 212); font-size: 10pt;">);</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">&nbsp; &nbsp; }</span></div><div><span style="color: rgb(212, 212, 212); font-size: 10pt;">)();</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 실패한 프라미스에서 발생한 에러는 보통 에러와 마찬가지로 Promise.all 로 전파됩니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 에러 떄문에 생긴 예외는 try..catch 로 감싸 잡을 수 있습니다.</span></div><br><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 요약</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// function 앞에 async 키워드를 추가하면 두 가지 효과가 있습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 1. 함수는 언제나 프라미스를 반환합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 2. 함수 안에서 await 를 사용할 수 있습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 프라미스 앞에 await 키워드를 붙이면 자바스크립트는 프라미스가 처리될 때까지 대기합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 처리가 완료되면 조건에 따라 아래와 같은 동작이 이어집니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 1. 에러 발생 - 예외가 생성됨(에러가 발생한 장소에서 throw error 를 호출한 것과 동일함)</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 2. 에러 미발생 - 프라미스 객체의 result 값을 반환</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async/await 를 함께 사용하면 읽고, 쓰기 쉬운 비동기 코드를 작성할 수 있습니다.</span></div><br><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// async/await 를 사용하면 promise.then/catch 가 거의 필요 없습니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 하지만 가끔 가장 바깥 스코프에서 비동기 처리가 필요할 때같이 promise.then/catch 를 써야 하는 경우가 생기기 때문에 async/await 가 프라미스를 기반으로 한다는 사실을 알고 계셔야합니다.</span></div><div><span style="color: rgb(106, 153, 85); font-size: 10pt;">// 여러 작업이 있고, 이 작업들이 모두 완료될 때까지 기다리려면 Promise.all 을 활용할 수 있다는 점도 알고 계시기 바랍니다.</span></div></div>